"use strict";var v=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var p=Object.prototype.hasOwnProperty;var w=(h,t)=>{for(var i in t)v(h,i,{get:t[i],enumerable:!0})},b=(h,t,i,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of u(t))!p.call(h,s)&&s!==i&&v(h,s,{get:()=>t[s],enumerable:!(e=m(t,s))||e.enumerable});return h};var E=h=>b(v({},"__esModule",{value:!0}),h);var x={};w(x,{Edge:()=>n,Graph:()=>o,InfiniteCanvas:()=>l,Node:()=>d,Serializer:()=>f});module.exports=E(x);var n=class{to;from;constructor(t,i){this.from=t,this.to=i}draw(t){t.beginPath(),t.moveTo(this.from.x,this.from.y),t.lineTo(this.to.x,this.to.y),t.stroke()}};var o=class{nodes=[];edges=[];addNode(t){this.nodes.push(t)}addEdge({from:t,to:i}){let e=new n(t,i);this.edges.push(e)}removeNode(t){this.nodes=this.nodes.filter(i=>i!==t),this.edges=this.edges.filter(i=>i.from!==t&&i.to!==t)}removeEdge(t){this.edges=this.edges.filter(i=>i!==t)}draw(t){this.nodes.forEach(i=>{i.draw(t)}),this.edges.forEach(i=>{i.draw(t)})}};var d=class{id;x;y;width;height;color;isHovered=!1;isDragging=!1;dragOffsetX=0;dragOffsetY=0;constructor({id:t,x:i,y:e,width:s=200,height:r=50,color:a="#444"}){this.id=t,this.x=i,this.y=e,this.width=s,this.height=r,this.color=a}onDragStart(t,i){this.isDragging=!0,this.dragOffsetX=t-this.x,this.dragOffsetY=i-this.y}onDragEnd(){this.isDragging=!1,this.dragOffsetX=0,this.dragOffsetY=0}onDrag(t,i){this.x=t-this.dragOffsetX,this.y=i-this.dragOffsetY}hoverOn(){this.isHovered=!0}hoverOff(){this.isHovered=!1}static createId(){return Math.random().toString(36).substring(2)}containsPoint(t,i){return t>=this.x&&t<=this.x+this.width&&i>=this.y&&i<=this.y+this.height}draw(t){t.shadowColor="rgba(0, 0, 0, 0.2)",t.shadowBlur=10,t.shadowOffsetX=5,t.shadowOffsetY=5;let i=5;t.fillStyle=this.color,t.beginPath(),t.moveTo(this.x+i,this.y),t.lineTo(this.x+this.width-i,this.y),t.quadraticCurveTo(this.x+this.width,this.y,this.x+this.width,this.y+i),t.lineTo(this.x+this.width,this.y+this.height-i),t.quadraticCurveTo(this.x+this.width,this.y+this.height,this.x+this.width-i,this.y+this.height),t.lineTo(this.x+i,this.y+this.height),t.quadraticCurveTo(this.x,this.y+this.height,this.x,this.y+this.height-i),t.lineTo(this.x,this.y+i),t.quadraticCurveTo(this.x,this.y,this.x+i,this.y),t.closePath(),t.fill(),t.strokeStyle="white",t.lineWidth=this.isHovered?2:1,t.stroke()}};var f=class{static serialize(t){let i=t.nodes.map(s=>({id:s.id,x:s.x,y:s.y,width:s.width,height:s.height,color:s.color})),e=t.edges.map(s=>({to:s.to.id,from:s.from.id}));return JSON.stringify({nodes:i,edges:e})}static deserialize(t){let{nodes:i,edges:e}=JSON.parse(t),s=new o;return i.forEach(r=>{s.addNode(new d({id:r.id,x:r.x,y:r.y,width:r.width,height:r.height,color:r.color}))}),e.forEach(r=>{let a=s.nodes.find(g=>g.id===r.from),c=s.nodes.find(g=>g.id===r.to);if(a&&c)s.addEdge({from:a,to:c});else throw new Error(`Invalid edge: ${r.from} -> ${r.to}`)}),s}};var l=class{canvas;ctx;graph;background;scale=1;offsetX=0;offsetY=0;isPanning=!1;startX=0;startY=0;isDragging=!1;constructor({canvas:t,background:i="#333"}){this.canvas=t,this.background=i,this.ctx=t.getContext("2d"),this.graph=new o,this.canvas.addEventListener("wheel",this.zoom.bind(this)),this.canvas.addEventListener("mousedown",this.startPan.bind(this)),this.canvas.addEventListener("mousemove",this.pan.bind(this)),this.canvas.addEventListener("mouseup",this.endPan.bind(this)),this.canvas.addEventListener("mouseleave",this.endPan.bind(this)),this.canvas.addEventListener("mousemove",this.hover.bind(this)),this.canvas.addEventListener("mousedown",this.startDrag.bind(this)),this.canvas.addEventListener("mousemove",this.drag.bind(this)),this.canvas.addEventListener("mouseup",this.dragEnd.bind(this)),this.resizeCanvas()}setGraph(t){this.graph=t,this.draw()}addNode({node:t}){this.graph.addNode(t),this.draw()}removeNode({node:t}){this.graph.removeNode(t),this.draw()}addEdge({edge:t}){this.graph.addEdge(t),this.draw()}removeEdge({edge:t}){this.graph.removeEdge(t),this.draw()}resizeCanvas(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.draw()}hover(t){let{x:i,y:e}=this.getMouseCoordinates(t);this.graph.nodes.forEach(s=>{s.containsPoint(i,e)?s.hoverOn():s.hoverOff()}),this.draw()}drag(t){if(!this.isDragging)return;let{x:i,y:e}=this.getMouseCoordinates(t);this.graph.nodes.filter(s=>s.isDragging).forEach(s=>s.onDrag(i,e)),this.draw()}dragEnd(){this.isDragging=!1,this.graph.nodes.forEach(t=>t.onDragEnd()),this.draw()}startDrag(t){this.isDragging=!1;let{x:i,y:e}=this.getMouseCoordinates(t);this.graph.nodes.forEach(s=>{s.containsPoint(i,e)&&(this.isDragging=!0,s.onDragStart(i,e))}),this.draw()}startPan(t){this.isPanning=!0,this.startX=t.clientX-this.offsetX,this.startY=t.clientY-this.offsetY}pan(t){!this.isPanning||this.isDragging||(this.offsetX=t.clientX-this.startX,this.offsetY=t.clientY-this.startY,this.draw())}endPan(){this.isPanning=!1}getMouseCoordinates(t){let i=this.canvas.getBoundingClientRect(),e={x:(t.clientX-i.left)/(i.right-i.left)*this.canvas.width,y:(t.clientY-i.top)/(i.bottom-i.top)*this.canvas.height},s=(e.x-this.offsetX)/this.scale,r=(e.y-this.offsetY)/this.scale;return{x:s,y:r}}zoom(t){t.preventDefault();let i=1.1,e=this.canvas.getBoundingClientRect(),s=t.clientX-e.left,r=t.clientY-e.top,a=t.deltaY<0,c=(s-this.offsetX)/this.scale,g=(r-this.offsetY)/this.scale;this.scale*=a?i:1/i,this.offsetX=s-c*this.scale,this.offsetY=r-g*this.scale,this.draw()}drawBackground(){this.ctx.fillStyle=this.background,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="rgba(255, 255, 255, 0.1)";for(let i=-this.offsetX%25;i<this.canvas.width;i+=25)for(let e=-this.offsetY%25;e<this.canvas.height;e+=25)this.ctx.beginPath(),this.ctx.arc(i,e,1,0,2*Math.PI),this.ctx.fill()}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawBackground(),this.ctx.save(),this.ctx.translate(this.offsetX,this.offsetY),this.ctx.scale(this.scale,this.scale),this.graph.draw(this.ctx),this.ctx.restore()}};0&&(module.exports={Edge,Graph,InfiniteCanvas,Node,Serializer});
//# sourceMappingURL=index.js.map